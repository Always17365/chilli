<?xml version="1.0" ?>
<fsm name ="AvayaVDN" initial="init">
<datamodel>
	<data id="monitorId"/>
	<data id="connectsArray"/>
</datamodel>
	<state id="init">
		<onentry>
			<script>connectsArray = new Array();</script>
		</onentry>
		<event event="ACS_OPEN_STREAM_CONF" cond="_event.OpenStream.status==0">
			<send target="this" type="cmd" dest="this" event="MonitorCallsViaDevice">
				<deviceId type="script">_avaya.Extension</deviceId>
			</send>
		</event>
		<event event="MonitorCallsViaDevice">
			<script>monitorId=_event.monitorId;</script>
			<!--timer idexpr="_extension.Extension" interval="10000"/-->
		</event>
		<event event="DELIVERED" cond="_event.delivered.connection.deviceID == _avaya.Extension">
			<send target="this" type="notify" dest="extension" eventexpr="_event._name">
				<event type="script">_event._name;</event>
				<extension >5000</extension>
				<delivered type="script">_event.delivered;</delivered>
			</send>
		</event>
		<event event="CONNECTION_CLEARED">
		</event>
    <event event=".*">
    </event>
    </state>
</fsm>

